<template>
  <moBg
    background-color="black"
    :range-y="800"
    :particle-count="500"
    :base-hue="120"
    class="min-h-screen w-full overflow-hidden size-full flex-col"
  >
    <!-- Hero Section -->
    <section
      ref="topSection"
      class="relative h-screen flex flex-col items-center justify-center px-4"
    >
      <!-- Background Effects -->
      <div
        class="absolute inset-0 bg-gradient-to-br from-purple-900/20 via-slate-900/50 to-black"
      ></div>
      <div
        class="absolute inset-0 opacity-40"
        style="
          background-image: url('data:image/svg+xml;utf8,<svg width=&quot;60&quot; height=&quot;60&quot; viewBox=&quot;0 0 60 60&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;><g fill=&quot;none&quot; fill-rule=&quot;evenodd&quot;><g fill=&quot;%239C92AC&quot; fill-opacity=&quot;0.05&quot;><circle cx=&quot;30&quot; cy=&quot;30&quot; r=&quot;1&quot;/></g></g></svg>');
        "
      ></div>

      <!-- Main Title -->
      <div class="relative z-10 text-center space-y-8 max-w-4xl">
        <motext
          words="INSPIRA UI"
          :delay="0.2"
          class="text-6xl md:text-8xl lg:text-9xl font-black bg-gradient-to-r from-purple-400 via-pink-400 to-red-400 bg-clip-text text-transparent"
        />

        <!-- Subtitle with morphing text -->
        <div class="space-y-4">
          <moResText
            :texts="heroTexts"
            :morphTime="2"
            :coolDownTime="1.5"
            class="text-2xl md:text-4xl text-purple-300/80 font-light"
          />
          <p
            class="text-lg md:text-xl text-slate-400 max-w-2xl mx-auto leading-relaxed"
          >
            æ¢ç´¢æœªæ¥è®¾è®¡çš„æ— é™å¯èƒ½ï¼Œæ‰“é€ ä»¤äººæƒŠè‰³çš„ç”¨æˆ·ä½“éªŒ
          </p>
        </div>

        <!-- CTA Buttons -->
        <div
          class="flex flex-col sm:flex-row items-center justify-center gap-6 pt-8"
        >
          <moButton
            text="å¼€å§‹æ¢ç´¢"
            @click="scrollToGallery"
            class="bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white border-0 px-8 py-4 text-lg font-semibold shadow-2xl shadow-purple-500/25"
          />
          <moButton
            text="äº†è§£æ›´å¤š"
            @click="scrollToFeatures"
            class="bg-gradient-to-r from-pink-300 to-pink-900 hover:from-purple-700 hover:to-orange-700 text-white border-0 px-10 py-5 text-xl font-semibold shadow-2xl shadow-purple-500/25"
          />
        </div>
      </div>

      <!-- Scroll Indicator -->
      <div
        class="absolute bottom-8 left-1/2 transform -translate-x-1/2 animate-bounce"
      >
        <div
          class="w-6 h-10 border-2 border-purple-400/50 rounded-full flex justify-center"
        >
          <div
            class="w-1 h-3 bg-purple-400 rounded-full mt-2 animate-pulse"
          ></div>
        </div>
      </div>
    </section>

    <!-- Gallery Section -->
    <section ref="gallerySection" class="relative py-20 px-4">
      <div class="max-w-7xl mx-auto">
        <div class="text-center mb-16">
          <motext
            words="ç²¾é€‰ä½œå“"
            :delay="0.05"
            class="text-4xl md:text-6xl font-bold text-white mb-6"
          />
          <p class="text-xl text-slate-400 max-w-2xl mx-auto">
            æ¯ä¸€ä¸ªä½œå“éƒ½æ˜¯åˆ›æ„ä¸æŠ€æœ¯çš„å®Œç¾ç»“åˆ
          </p>
        </div>

        <div class="h-[600px] w-full relative z-10">
          <moImglist
            :items="galleryItems"
            :bend="25"
            :border-radius="0.15"
            textColor="#e2e8f0"
            font="bold 28px Inter, sans-serif"
          />
        </div>

        <!-- æ·»åŠ ä¸€äº›é—´è·ç¡®ä¿åç»­å†…å®¹å¯è§ -->
        <div
          class="flex flex-col sm:flex-row items-center justify-center gap-6 pt-8"
        >
          <moButton
            text="æ›´å¤šç²¾å½©"
            @click="scrollToFeatures"
            class="bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white border-0 px-8 py-4 text-lg font-semibold shadow-2xl shadow-purple-500/25"
          />
        </div>
      </div>
    </section>

    <!-- Features Section -->
    <section
      ref="featuresSection"
      class="relative py-20 px-4 bg-gradient-to-r from-slate-900/50 to-purple-900/30"
    >
      <div class="max-w-6xl mx-auto">
        <div class="text-center mb-16">
          <motext
            words="æ ¸å¿ƒç‰¹æ€§"
            :delay="0.05"
            class="text-4xl md:text-6xl font-bold text-white mb-6"
          />
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
          <div
            v-for="(feature, index) in features"
            :key="index"
            class="group relative p-8 bg-slate-800/50 backdrop-blur-sm rounded-2xl border border-slate-700/50 hover:border-purple-500/50 transition-all duration-300 hover:transform hover:scale-105"
          >
            <div
              class="absolute inset-0 bg-gradient-to-br from-purple-600/10 to-pink-600/10 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"
            ></div>
            <div class="relative z-10">
              <div class="text-4xl mb-4">{{ feature.icon }}</div>
              <h3 class="text-xl font-bold text-white mb-3">
                {{ feature.title }}
              </h3>
              <p class="text-slate-400 leading-relaxed">
                {{ feature.description }}
              </p>
            </div>
          </div>
        </div>
        <div
          class="flex flex-col sm:flex-row items-center justify-center gap-6 pt-8"
        >
          <moButton
            text="æ–°çš„æœªæ¥"
            @click="scrollTostartSection"
            class="bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white border-0 px-8 py-4 text-lg font-semibold shadow-2xl shadow-purple-500/25"
          />
        </div>
      </div>
    </section>

    <!-- CTA Section -->
    <section class="relative py-20 px-4" ref="startSection">
      <div class="max-w-4xl mx-auto text-center">
        <motext
          words="å‡†å¤‡å¼€å§‹äº†å—ï¼Ÿ"
          :delay="0.08"
          class="text-4xl md:text-6xl font-bold text-white mb-8"
        />
        <p class="text-xl text-slate-400 mb-12 max-w-2xl mx-auto">
          åŠ å…¥æˆ‘ä»¬ï¼Œä¸€èµ·åˆ›é€ ä¸‹ä¸€ä»£çš„ç”¨æˆ·ç•Œé¢ä½“éªŒ
        </p>
        <div class="grid place-content-center p-6">
          <moIconTree :images="imageUrls" />
        </div>
        <div
          class="flex flex-col sm:flex-row items-center justify-center gap-6"
        >
          <moButton
            text="åŠ å…¥æˆ‘ä»¬"
            @click="activatePortal"
            class="bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white border-0 px-10 py-5 text-xl font-semibold shadow-2xl shadow-purple-500/25"
          />
          <moButton
            text="è¿”å›é¡¶éƒ¨"
            @click="handleViewDocs"
            class="bg-gradient-to-r from-yellow-300 to-yellow-900 hover:from-purple-700 hover:to-pink-700 text-white border-0 px-10 py-5 text-xl font-semibold shadow-2xl shadow-purple-500/25"
          />
        </div>
      </div>
    </section>

    <!-- Cosmic Portal (Hidden by default) -->
    <div
      v-if="showPortal"
      class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm"
    >
      <div class="relative w-full" style="height: 80%">
        <CosmicPortal ref="cosmicPortal" container-class="rounded-lg" />
        <div
          class="flex flex-col sm:flex-row items-center justify-center gap-6 pt-8"
        >
          <moButton
            text="æ›´æ¢é¢œè‰²"
            @click="shiftDimensions"
            class="bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white border-0 px-8 py-4 text-lg font-semibold shadow-2xl shadow-purple-500/25"
          />
          <moButton
            text="å…³é—­"
            @click="closePortal"
            class="bg-gradient-to-r from-green-600 to-green-300 hover:from-purple-700 hover:to-pink-700 text-white border-0 px-8 py-4 text-lg font-semibold shadow-2xl shadow-purple-500/25"
          />
        </div>
      </div>
    </div>
    <mofoucs />
  </moBg>
</template>

<script lang="ts" setup>
import CosmicPortal from "./CosmicPortal.vue";
import { ref, useTemplateRef, onMounted } from "vue";
import moButton from "@/componentsNew/moButton.vue";
import motext from "@/componentsNew/motext.vue";
import moImglist from "@/componentsNew/moImglist.vue";
import moResText from "@/componentsNew/moResText.vue";
import moBg from "@/componentsNew/moBg.vue";
import mofoucs from "@/componentsNew/mofoucs.vue";
import moIconTree from "@/componentsNew/moIconTree.vue";
import confetti from "canvas-confetti";
// Refs
const cosmicPortal = useTemplateRef("cosmicPortal");
const gallerySection = ref<HTMLElement>();
const featuresSection = ref<HTMLElement>();
const showPortal = ref(false);

// Hero section texts
const heroTexts = ref<string[]>([
  "åˆ›æ–°æœªæ¥",
  "æè‡´æ¸¸æˆ",
  "æœªæ¥ç•Œé¢",
  "æ— é™è¿­ä»£",
]);

// Gallery items
const galleryItems = ref<Array<{ image: string; text: string }>>([
  {
    image:
      "https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=800&h=600&fit=crop",
    text: "ç°ä»£è®¾è®¡",
  },
  {
    image:
      "https://images.unsplash.com/photo-1586717791821-3f44a563fa4c?w=800&h=600&fit=crop",
    text: "åˆ›æ–°ç•Œé¢",
  },
  {
    image:
      "https://images.unsplash.com/photo-1551650975-87deedd944c3?w=800&h=600&fit=crop",
    text: "ç”¨æˆ·ä½“éªŒ",
  },
  {
    image:
      "https://images.unsplash.com/photo-1460925895917-afdab827c52f?w=800&h=600&fit=crop",
    text: "æ•°æ®å¯è§†åŒ–",
  },
  {
    image:
      "https://images.unsplash.com/photo-1504384308090-c894fdcc538d?w=800&h=600&fit=crop",
    text: "ç§»åŠ¨ä¼˜å…ˆ",
  },
  {
    image:
      "https://images.unsplash.com/photo-1517077304055-6e89abbf09b0?w=800&h=600&fit=crop",
    text: "å“åº”å¼è®¾è®¡",
  },
]);

// Features data
const features = ref([
  {
    icon: "ğŸš€",
    title: "æé€Ÿæ€§èƒ½",
    description: "åŸºäºç°ä»£æŠ€æœ¯æ ˆæ„å»ºï¼Œç¡®ä¿æœ€ä½³çš„åŠ è½½é€Ÿåº¦å’Œç”¨æˆ·ä½“éªŒ",
  },
  {
    icon: "ğŸ¨",
    title: "ç²¾ç¾è®¾è®¡",
    description: "æ¯ä¸ªç»„ä»¶éƒ½ç»è¿‡ç²¾å¿ƒè®¾è®¡ï¼Œç¬¦åˆç°ä»£å®¡ç¾å’Œç”¨æˆ·ä¹ æƒ¯",
  },
  {
    icon: "ğŸ“±",
    title: "å“åº”å¼å¸ƒå±€",
    description: "å®Œç¾é€‚é…å„ç§è®¾å¤‡å°ºå¯¸ï¼Œä»æ‰‹æœºåˆ°æ¡Œé¢ç«¯éƒ½æœ‰å‡ºè‰²è¡¨ç°",
  },
  {
    icon: "âš¡",
    title: "åŠ¨ç”»æ•ˆæœ",
    description: "æµç•…çš„åŠ¨ç”»å’Œè¿‡æ¸¡æ•ˆæœï¼Œè®©ç•Œé¢æ›´åŠ ç”ŸåŠ¨æœ‰è¶£",
  },
  {
    icon: "ğŸ”§",
    title: "æ˜“äºå®šåˆ¶",
    description: "çµæ´»çš„é…ç½®é€‰é¡¹ï¼Œè½»æ¾é€‚åº”ä¸åŒçš„è®¾è®¡éœ€æ±‚",
  },
  {
    icon: "ğŸŒŸ",
    title: "ç°ä»£æŠ€æœ¯",
    description: "é‡‡ç”¨Vue 3ã€TypeScriptç­‰å‰æ²¿æŠ€æœ¯ï¼Œä¿è¯ä»£ç è´¨é‡",
  },
]);

const slugs = [
  "typescript",
  "javascript",
  "dart",
  "java",
  "react",
  "flutter",
  "android",
  "html5",
  "css3",
  "nodedotjs",
  "express",
  "nextdotjs",
  "prisma",
  "amazonaws",
  "postgresql",
  "firebase",
  "nginx",
  "vercel",
  "testinglibrary",
  "jest",
  "cypress",
  "docker",
  "git",
  "jira",
  "github",
  "gitlab",
  "visualstudiocode",
  "androidstudio",
  "sonarqube",
  "figma",
];

const imageUrls = slugs.map(
  (slug) => `https://cdn.simpleicons.org/${slug}/${slug}`
);

// Methods
function scrollToGallery() {
  gallerySection.value?.scrollIntoView({ behavior: "smooth" });
}

function scrollToFeatures() {
  featuresSection.value?.scrollIntoView({ behavior: "smooth" });
}
const startSection = ref<HTMLElement>();
const scrollTostartSection = () => {
  startSection.value?.scrollIntoView({ behavior: "smooth" });
};

function handleGetStarted() {
  showPortal.value = true;
  setTimeout(() => {
    if (cosmicPortal.value) {
      cosmicPortal.value.activatePortal();
    }
  }, 100);
}

const topSection = useTemplateRef("topSection");
function handleViewDocs() {
  topSection.value?.scrollIntoView({ behavior: "smooth" });
  makeYh();
}
function makeYh() {
  const end = Date.now() + 3 * 1000; // 3 seconds
  const colors = ["#a786ff", "#fd8bbc", "#eca184", "#f8deb1"];

  // Frame function to trigger confetti cannons
  function frame() {
    if (Date.now() > end) return;

    // Left side confetti cannon
    confetti({
      particleCount: 2,
      angle: 60,
      spread: 55,
      startVelocity: 60,
      origin: { x: 0, y: 0.5 },
      colors: colors,
    });

    // Right side confetti cannon
    confetti({
      particleCount: 2,
      angle: 120,
      spread: 55,
      startVelocity: 60,
      origin: { x: 1, y: 0.5 },
      colors: colors,
    });

    requestAnimationFrame(frame); // Keep calling the frame function
  }

  frame();
}

function closePortal() {
  showPortal.value = false;
}

function activatePortal() {
  showPortal.value = true;
  setTimeout(() => {
    if (cosmicPortal.value) {
      cosmicPortal.value.activatePortal();
    }
  }, 100);
}

function shiftDimensions() {
  if (cosmicPortal.value) {
    cosmicPortal.value.shiftDimensions();
  }
}

onMounted(() => {
  makeYh();
});
</script>
